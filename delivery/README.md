# Delivery

## sudo nmap -sV -sC -oA nmap/delivery delivery.htb

[Scan result][1]
There is a web server on port 80 which gives us some hints. In fact there is a helpdesk subdomain and a mattermost server on port 8065. Mattermost is a web chat service

## Helpdesk and Mattermost

Going on `helpdesk.delivery.htb` there is a osticket web app.

Following instruction on the main web site, first of all open a new ticket and use the mail generated by the helpdesk site to register a new account on mattermost

`7145694@delivery.htb:r6bPaftN8iF4QWB!`

Once in the mattermost chat we get some hint to go on. So logon into the staff console of `osticket` using ***maildeliverer:Youve_G0t_Mail!*** we can use this cred to get an ssh shell also.

## Rooting

In the mattermost we get an hint to get root `PleaseSubscribe! may not be in RockYou but if any hacker manages to get our hashes, they can use hashcat rules to easily crack all variations of common words or phrases.`

So to get root we need two things:

- a password hash
- hashcat with some rules

Launch linpeas on the target machine but doesnt find nothing intresting.

Using `find -readable` we found the directory in which mattermost is installed and inside the config file there is a mysql user: ***mmuser:Crack_The_MM_Admin_PW***

connecting to mysql console and get some information `mysql -u mmuser -p`

```mysql
use mattermost;
show tables;
select * from Users where Users.Username = "root";
```

And we now have the hash `$2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v0EFJwgjjO`

We know that the password is a variant of `PleaseSubscribe!` so we can create a dictionary and use hashcat rules to get the correct password.

`hashcat --stdout ippsec.txt -r rules/best64.rule | hashcat -m 3200 delivery.txt` and wait for the password.

After some seconds we get our password: ***root:PleaseSubscribe!21***

login via `su` and get the flag!

![htbbadge](https://www.hackthebox.eu/badge/image/272787)

[//]: #links
[1]: nmap/delivery.nmap
